include Headers\windows.h.txt

header
alias PFN_SC_NOTIFY_CALLBACK LPVOID

alias SERVICE_STATUS_HANDLE HANDLE

alias SC_HANDLE HANDLE

alias SC_LOCK LPVOID

enum SC_STATUS_TYPE UINT
  SC_STATUS_PROCESS_INFO 0

flag [ServiceType] DWORD display=DWORD
  SERVICE_KERNEL_DRIVER       0x00000001
  SERVICE_FILE_SYSTEM_DRIVER  0x00000002
  SERVICE_ADAPTER             0x00000004
  SERVICE_RECOGNIZER_DRIVER   0x00000008
  SERVICE_DRIVER              0x0000000B
  SERVICE_WIN32_OWN_PROCESS   0x00000010
  SERVICE_WIN32_SHARE_PROCESS 0x00000020
  SERVICE_WIN32               0x00000030
  SERVICE_INTERACTIVE_PROCESS 0x00000100
  SERVICE_NO_CHANGE           0xffffffff

flag [ServiceState] DWORD display=DWORD
  SERVICE_ACTIVE    0x00000001
  SERVICE_INACTIVE  0x00000002
  SERVICE_STATE_ALL 0x00000003

enum [ServiceCurrentState] DWORD display=DWORD
  SERVICE_STOPPED          0x00000001
  SERVICE_START_PENDING    0x00000002
  SERVICE_STOP_PENDING     0x00000003
  SERVICE_RUNNING          0x00000004
  SERVICE_CONTINUE_PENDING 0x00000005
  SERVICE_PAUSE_PENDING    0x00000006
  SERVICE_PAUSED           0x00000007

enum [ServiceStartType] DWORD display=DWORD
  SERVICE_BOOT_START   0x00000000
  SERVICE_SYSTEM_START 0x00000001
  SERVICE_AUTO_START   0x00000002
  SERVICE_DEMAND_START 0x00000003
  SERVICE_DISABLED     0x00000004
  SERVICE_NO_CHANGE    0xffffffff

enum [ServiceErrorControl] DWORD display=DWORD
  SERVICE_ERROR_IGNORE   0x00000000
  SERVICE_ERROR_NORMAL   0x00000001
  SERVICE_ERROR_SEVERE   0x00000002
  SERVICE_ERROR_CRITICAL 0x00000003
  SERVICE_NO_CHANGE      0xffffffff

enum [ServiceInfoLevel] DWORD display=DWORD
  SERVICE_CONFIG_DESCRIPTION              1
  SERVICE_CONFIG_FAILURE_ACTIONS          2
  SERVICE_CONFIG_DELAYED_AUTO_START_INFO  3
  SERVICE_CONFIG_FAILURE_ACTIONS_FLAG     4
  SERVICE_CONFIG_SERVICE_SID_INFO         5
  SERVICE_CONFIG_REQUIRED_PRIVILEGES_INFO 6
  SERVICE_CONFIG_PRESHUTDOWN_INFO         7
  SERVICE_CONFIG_TRIGGER_INFO             8
  SERVICE_CONFIG_PREFERRED_NODE           9

flag [SCManagerAccess] DWORD display=DWORD
  SC_MANAGER_CONNECT            0x0001
  SC_MANAGER_CREATE_SERVICE     0x0002
  SC_MANAGER_ENUMERATE_SERVICE  0x0004
  SC_MANAGER_LOCK               0x0008
  SC_MANAGER_QUERY_LOCK_STATUS  0x0010
  SC_MANAGER_MODIFY_BOOT_CONFIG 0x0020
  SC_MANAGER_ALL_ACCESS         0xF003F
  GENERIC_EXECUTE               0x20000000
  GENERIC_WRITE                 0x40000000
  GENERIC_READ                  0x80000000

flag [ServiceAccess] DWORD display=DWORD
  SERVICE_QUERY_CONFIG         0x0001
  SERVICE_CHANGE_CONFIG        0x0002
  SERVICE_QUERY_STATUS         0x0004
  SERVICE_ENUMERATE_DEPENDENTS 0x0008
  SERVICE_START                0x0010
  SERVICE_STOP                 0x0020
  SERVICE_PAUSE_CONTINUE       0x0040
  SERVICE_INTERROGATE          0x0080
  SERVICE_USER_DEFINED_CONTROL 0x0100
  DELETE                       0x00010000
  READ_CONTROL                 0x00020000
  WRITE_DAC                    0x00040000
  WRITE_OWNER                  0x00080000
  SERVICE_ALL_ACCESS           0xF01FF
  ACCESS_SYSTEM_SECURITY       0x01000000
  MAXIMUM_ALLOWED              0x02000000
  GENERIC_EXECUTE              0x20000000
  GENERIC_WRITE                0x40000000
  GENERIC_READ                 0x80000000

enum [ServiceControl] DWORD display=DWORD
  SERVICE_CONTROL_STOP                  0x00000001
  SERVICE_CONTROL_PAUSE                 0x00000002
  SERVICE_CONTROL_CONTINUE              0x00000003
  SERVICE_CONTROL_INTERROGATE           0x00000004
  SERVICE_CONTROL_SHUTDOWN              0x00000005
  SERVICE_CONTROL_PARAMCHANGE           0x00000006
  SERVICE_CONTROL_NETBINDADD            0x00000007
  SERVICE_CONTROL_NETBINDREMOVE         0x00000008
  SERVICE_CONTROL_NETBINDENABLE         0x00000009
  SERVICE_CONTROL_NETBINDDISABLE        0x0000000A
  SERVICE_CONTROL_DEVICEEVENT           0x0000000B
  SERVICE_CONTROL_HARDWAREPROFILECHANGE 0x0000000C
  SERVICE_CONTROL_POWEREVENT            0x0000000D
  SERVICE_CONTROL_SESSIONCHANGE         0x0000000E
  SERVICE_CONTROL_PRESHUTDOWN           0x0000000F

flag [ServiceAcceptControls] DWORD display=DWORD
  SERVICE_ACCEPT_STOP                  0x00000001
  SERVICE_ACCEPT_PAUSE_CONTINUE        0x00000002
  SERVICE_ACCEPT_SHUTDOWN              0x00000004
  SERVICE_ACCEPT_PARAMCHANGE           0x00000008
  SERVICE_ACCEPT_NETBINDCHANGE         0x00000010
  SERVICE_ACCEPT_HARDWAREPROFILECHANGE 0x00000020
  SERVICE_ACCEPT_POWEREVENT            0x00000040
  SERVICE_ACCEPT_SESSIONCHANGE         0x00000080
  SERVICE_ACCEPT_PRESHUTDOWN           0x00000100
  SERVICE_ACCEPT_TIMECHANGE            0x00000200
  SERVICE_ACCEPT_TRIGGEREVENT          0x00000400

flag [ServiceNotifyMask] DWORD display=DWORD
  SERVICE_NOTIFY_STOPPED          0x00000001
  SERVICE_NOTIFY_START_PENDING    0x00000002
  SERVICE_NOTIFY_STOP_PENDING     0x00000004
  SERVICE_NOTIFY_RUNNING          0x00000008
  SERVICE_NOTIFY_CONTINUE_PENDING 0x00000010
  SERVICE_NOTIFY_PAUSE_PENDING    0x00000020
  SERVICE_NOTIFY_PAUSED           0x00000040
  SERVICE_NOTIFY_CREATED          0x00000080
  SERVICE_NOTIFY_DELETED          0x00000100
  SERVICE_NOTIFY_DELETE_PENDING   0x00000200

flag [ServiceFlags] DWORD display=DWORD
  SERVICE_RUNS_IN_SYSTEM_PROCESS 0x00000001

struct SERVICE_STATUS_PROCESS
  dwServiceType [ServiceType]
  dwCurrentState [ServiceCurrentState]
  dwControlsAccepted [ServiceAcceptControls]
  dwWin32ExitCode DWORD
  dwServiceSpecificExitCode DWORD
  dwCheckPoint DWORD
  dwWaitHint DWORD
  dwProcessId DWORD
  dwServiceFlags [ServiceFlags]

struct SERVICE_NOTIFY
  dwVersion DWORD
  pfnNotifyCallback PFN_SC_NOTIFY_CALLBACK
  pContext PVOID
  dwNotificationStatus DWORD
  ServiceStatus SERVICE_STATUS_PROCESS
  dwNotificationTriggered DWORD
  pszServiceNames LPTSTR

pointer PSERVICE_NOTIFY SERVICE_NOTIFY

struct SERVICE_NOTIFYA
  dwVersion DWORD
  pfnNotifyCallback PFN_SC_NOTIFY_CALLBACK
  pContext PVOID
  dwNotificationStatus DWORD
  ServiceStatus SERVICE_STATUS_PROCESS
  dwNotificationTriggered DWORD
  pszServiceNames LPSTR

pointer PSERVICE_NOTIFYA SERVICE_NOTIFYA

struct SERVICE_STATUS
  dwServiceType [ServiceType]
  dwCurrentState [ServiceCurrentState]
  dwControlsAccepted [ServiceAcceptControls]
  dwWin32ExitCode DWORD
  dwServiceSpecificExitCode DWORD
  dwCheckPoint DWORD
  dwWaitHint DWORD

pointer LPSERVICE_STATUS SERVICE_STATUS

alias LPSERVICE_MAIN_FUNCTION LPVOID

struct SERVICE_TABLE_ENTRY
  lpServiceName LPTSTR
  lpServiceProc LPSERVICE_MAIN_FUNCTION

pointer "const SERVICE_TABLE_ENTRY*" SERVICE_TABLE_ENTRY

struct ENUM_SERVICE_STATUS
  lpServiceName LPTSTR
  lpDisplayName LPTSTR
  ServiceStatus SERVICE_STATUS

pointer LPENUM_SERVICE_STATUS ENUM_SERVICE_STATUS

struct QUERY_SERVICE_CONFIG
  dwServiceType [ServiceType]
  dwStartType [ServiceStartType]
  dwErrorControl [ServiceErrorControl]
  lpBinaryPathName LPTSTR
  lpLoadOrderGroup LPTSTR
  dwTagId DWORD
  lpDependencies LPTSTR
  lpServiceStartName LPTSTR
  lpDisplayName LPTSTR

pointer LPQUERY_SERVICE_CONFIG QUERY_SERVICE_CONFIG

struct QUERY_SERVICE_LOCK_STATUS
  fIsLocked DWORD
  lpLockOwner LPTSTR
  dwLockDuration DWORD

pointer LPQUERY_SERVICE_LOCK_STATUS QUERY_SERVICE_LOCK_STATUS

