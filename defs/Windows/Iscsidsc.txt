include Headers\windows.h.txt

dll Iscsidsc.dll callingConvention=STDCALL errorFunc=HRESULT onlineHelp=MSDN
category "Devices/iSCSI Discovery Library"
array "TCHAR [MAX_ISCSI_PORTAL_NAME_LEN]" base=TCHAR count=256

array "TCHAR [MAX_ISCSI_PORTAL_ADDRESS_LEN]" base=TCHAR count=256

array "TCHAR [MAX_ISCSI_HBANAME_LEN]" base=TCHAR count=256

array "TCHAR [MAX_ISCSI_NAME_LEN + 1]" base=TCHAR count=224

array "UCHAR [6]" base=UCHAR count=6

struct ISCSI_UNIQUE_SESSION_ID
  AdapterUnique ULONGLONG
  AdapterSpecific ULONGLONG

pointer PISCSI_UNIQUE_SESSION_ID ISCSI_UNIQUE_SESSION_ID

pointer PISCSI_UNIQUE_SESSION_ID* PISCSI_UNIQUE_SESSION_ID

alias ISCSI_UNIQUE_CONNECTION_ID ISCSI_UNIQUE_SESSION_ID

pointer PISCSI_UNIQUE_CONNECTION_ID ISCSI_UNIQUE_CONNECTION_ID

flag ISCSI_LOGIN_OPTIONS_INFO_SPECIFIED ULONG
  ISCSI_LOGIN_OPTIONS_HEADER_DIGEST         0x00000001
  ISCSI_LOGIN_OPTIONS_DATA_DIGEST           0x00000002
  ISCSI_LOGIN_OPTIONS_MAXIMUM_CONNECTIONS   0x00000004
  ISCSI_LOGIN_OPTIONS_DEFAULT_TIME_2_WAIT   0x00000008
  ISCSI_LOGIN_OPTIONS_DEFAULT_TIME_2_RETAIN 0x00000010
  ISCSI_LOGIN_OPTIONS_USERNAME              0x00000020
  ISCSI_LOGIN_OPTIONS_PASSWORD              0x00000040
  ISCSI_LOGIN_OPTIONS_AUTH_TYPE             0x00000080

flag ISCSI_LOGIN_FLAGS ULONG
  ISCSI_LOGIN_FLAG_REQUIRE_IPSEC           0x00000001
  ISCSI_LOGIN_FLAG_MULTIPATH_ENABLED       0x00000002
  ISCSI_LOGIN_FLAG_RESERVED1               0x00000004
  ISCSI_LOGIN_FLAG_ALLOW_PORTAL_HOPPING    0x00000008
  ISCSI_LOGIN_FLAG_USE_RADIUS_RESPONSE     0x00000010
  ISCSI_LOGIN_FLAG_USE_RADIUS_VERIFICATION 0x00000020

enum ISCSI_AUTH_TYPES UINT32
  ISCSI_NO_AUTH_TYPE          0
  ISCSI_CHAP_AUTH_TYPE        1
  ISCSI_MUTUAL_CHAP_AUTH_TYPE 2

enum ISCSI_DIGEST_TYPES UINT
  ISCSI_DIGEST_TYPE_NONE   0
  ISCSI_DIGEST_TYPE_CRC32C 1

struct ISCSI_LOGIN_OPTIONS
  Version ULONG
  InformationSpecified ISCSI_LOGIN_OPTIONS_INFO_SPECIFIED
  LoginFlags ISCSI_LOGIN_FLAGS
  AuthType ISCSI_AUTH_TYPES
  HeaderDigest ISCSI_DIGEST_TYPES
  DataDigest ISCSI_DIGEST_TYPES
  MaximumConnections ULONG
  DefaultTime2Wait ULONG
  DefaultTime2Retain ULONG
  UsernameLength ULONG
  PasswordLength ULONG
  Username PUCHAR length=UsernameLength
  Password PUCHAR length=PasswordLength

pointer PISCSI_LOGIN_OPTIONS ISCSI_LOGIN_OPTIONS

struct ISCSI_VERSION_INFO
  MajorVersion ULONG
  MinorVersion ULONG
  BuildNumber ULONG

pointer PISCSI_VERSION_INFO ISCSI_VERSION_INFO

enum ISDSC_STATUS [ERROR_CODE]
  ISDSC_OPERATION_NOT_ALL_SUCCESS              0xAFFF002E
  ISDSC_OPERATION_REQUIRES_REBOOT              0xAFFF003B
  ISDSC_SHORT_CHAP_SECRET                      0xAFFF0048
  ISDSC_NON_SPECIFIC_ERROR                     0xEFFF0001
  ISDSC_LOGIN_FAILED                           0xEFFF0002
  ISDSC_CONNECTION_FAILED                      0xEFFF0003
  ISDSC_INITIATOR_NODE_ALREADY_EXISTS          0xEFFF0004
  ISDSC_INITIATOR_NODE_NOT_FOUND               0xEFFF0005
  ISDSC_TARGET_MOVED_TEMPORARILY               0xEFFF0006
  ISDSC_TARGET_MOVED_PERMANENTLY               0xEFFF0007
  ISDSC_INITIATOR_ERROR                        0xEFFF0008
  ISDSC_AUTHENTICATION_FAILURE                 0xEFFF0009
  ISDSC_AUTHORIZATION_FAILURE                  0xEFFF000A
  ISDSC_NOT_FOUND                              0xEFFF000B
  ISDSC_TARGET_REMOVED                         0xEFFF000C
  ISDSC_UNSUPPORTED_VERSION                    0xEFFF000D
  ISDSC_TOO_MANY_CONNECTIONS                   0xEFFF000E
  ISDSC_MISSING_PARAMETER                      0xEFFF000F
  ISDSC_CANT_INCLUDE_IN_SESSION                0xEFFF0010
  ISDSC_SESSION_TYPE_NOT_SUPPORTED             0xEFFF0011
  ISDSC_TARGET_ERROR                           0xEFFF0012
  ISDSC_SERVICE_UNAVAILABLE                    0xEFFF0013
  ISDSC_OUT_OF_RESOURCES                       0xEFFF0014
  ISDSC_CONNECTION_ALREADY_EXISTS              0xEFFF0015
  ISDSC_SESSION_ALREADY_EXISTS                 0xEFFF0016
  ISDSC_INITIATOR_INSTANCE_NOT_FOUND           0xEFFF0017
  ISDSC_TARGET_ALREADY_EXISTS                  0xEFFF0018
  ISDSC_DRIVER_BUG                             0xEFFF0019
  ISDSC_INVALID_TEXT_KEY                       0xEFFF001A
  ISDSC_INVALID_SENDTARGETS_TEXT               0xEFFF001B
  ISDSC_INVALID_SESSION_ID                     0xEFFF001C
  ISDSC_SCSI_REQUEST_FAILED                    0xEFFF001D
  ISDSC_TOO_MANY_SESSIONS                      0xEFFF001E
  ISDSC_SESSION_BUSY                           0xEFFF001F
  ISDSC_TARGET_MAPPING_UNAVAILABLE             0xEFFF0020
  ISDSC_ADDRESS_TYPE_NOT_SUPPORTED             0xEFFF0021
  ISDSC_LOGON_FAILED                           0xEFFF0022
  ISDSC_SEND_FAILED                            0xEFFF0023
  ISDSC_TRANSPORT_ERROR                        0xEFFF0024
  ISDSC_VERSION_MISMATCH                       0xEFFF0025
  ISDSC_TARGET_MAPPING_OUT_OF_RANGE            0xEFFF0026
  ISDSC_TARGET_PRESHAREDKEY_UNAVAILABLE        0xEFFF0027
  ISDSC_TARGET_AUTHINFO_UNAVAILABLE            0xEFFF0028
  ISDSC_TARGET_NOT_FOUND                       0xEFFF0029
  ISDSC_LOGIN_USER_INFO_BAD                    0xEFFF002A
  ISDSC_TARGET_MAPPING_EXISTS                  0xEFFF002B
  ISDSC_HBA_SECURITY_CACHE_FULL                0xEFFF002C
  ISDSC_INVALID_PORT_NUMBER                    0xEFFF002D
  ISDSC_HBA_SECURITY_CACHE_NOT_SUPPORTED       0xEFFF002F
  ISDSC_IKE_ID_PAYLOAD_TYPE_NOT_SUPPORTED      0xEFFF0030
  ISDSC_IKE_ID_PAYLOAD_INCORRECT_SIZE          0xEFFF0031
  ISDSC_TARGET_PORTAL_ALREADY_EXISTS           0xEFFF0032
  ISDSC_TARGET_ADDRESS_ALREADY_EXISTS          0xEFFF0033
  ISDSC_NO_AUTH_INFO_AVAILABLE                 0xEFFF0034
  ISDSC_NO_TUNNEL_OUTER_MODE_ADDRESS           0xEFFF0035
  ISDSC_CACHE_CORRUPTED                        0xEFFF0036
  ISDSC_REQUEST_NOT_SUPPORTED                  0xEFFF0037
  ISDSC_TARGET_OUT_OF_RESORCES                 0xEFFF0038
  ISDSC_SERVICE_DID_NOT_RESPOND                0xEFFF0039
  ISDSC_ISNS_SERVER_NOT_FOUND                  0xEFFF003A
  ISDSC_NO_PORTAL_SPECIFIED                    0xEFFF003C
  ISDSC_CANT_REMOVE_LAST_CONNECTION            0xEFFF003D
  ISDSC_SERVICE_NOT_RUNNING                    0xEFFF003E
  ISDSC_TARGET_ALREADY_LOGGED_IN               0xEFFF003F
  ISDSC_DEVICE_BUSY_ON_SESSION                 0xEFFF0040
  ISDSC_COULD_NOT_SAVE_PERSISTENT_LOGIN_DATA   0xEFFF0041
  ISDSC_COULD_NOT_REMOVE_PERSISTENT_LOGIN_DATA 0xEFFF0042
  ISDSC_PORTAL_NOT_FOUND                       0xEFFF0043
  ISDSC_INITIATOR_NOT_FOUND                    0xEFFF0044
  ISDSC_DISCOVERY_MECHANISM_NOT_FOUND          0xEFFF0045
  ISDSC_IPSEC_NOT_SUPPORTED_ON_OS              0xEFFF0046
  ISDSC_PERSISTENT_LOGIN_TIMEOUT               0xEFFF0047
  ISDSC_EVALUATION_PEROID_EXPIRED              0xEFFF0049
  ISDSC_INVALID_CHAP_SECRET                    0xEFFF004A
  ISDSC_INVALID_TARGET_CHAP_SECRET             0xEFFF004B
  ISDSC_INVALID_INITIATOR_CHAP_SECRET          0xEFFF004C
  ISDSC_INVALID_CHAP_USER_NAME                 0xEFFF004D
  ISDSC_INVALID_LOGON_AUTH_TYPE                0xEFFF004E
  ISDSC_INVALID_TARGET_MAPPING                 0xEFFF004F
  ISDSC_INVALID_TARGET_ID                      0xEFFF0050
  ISDSC_INVALID_ISCSI_NAME                     0xEFFF0051
  ISDSC_INCOMPATIBLE_ISNS_VERSION              0xEFFF0052
  ISDSC_FAILED_TO_CONFIGURE_IPSEC              0xEFFF0053
  ISDSC_BUFFER_TOO_SMALL                       0xEFFF0054
  ISDSC_INVALID_LOAD_BALANCE_POLICY            0xEFFF0055
  ISDSC_INVALID_PARAMETER                      0xEFFF0056
  ISDSC_DUPLICATE_PATH_SPECIFIED               0xEFFF0057
  ISDSC_PATH_COUNT_MISMATCH                    0xEFFF0058
  ISDSC_INVALID_PATH_ID                        0xEFFF0059
  ISDSC_MULTIPLE_PRIMARY_PATHS_SPECIFIED       0xEFFF005A
  ISDSC_NO_PRIMARY_PATH_SPECIFIED              0xEFFF005B
  ISDSC_DEVICE_ALREADY_PERSISTENTLY_BOUND      0xEFFF005C
  ISDSC_DEVICE_NOT_FOUND                       0xEFFF005D
  ISDSC_DEVICE_NOT_ISCSI_OR_PERSISTENT         0xEFFF005E
  ISDSC_DNS_NAME_UNRESOLVED                    0xEFFF005F
  ISDSC_NO_CONNECTION_AVAILABLE                0xEFFF0060
  ISDSC_LB_POLICY_NOT_SUPPORTED                0xEFFF0061
  ISDSC_REMOVE_CONNECTION_IN_PROGRESS          0xEFFF0062
  ISDSC_INVALID_CONNECTION_ID                  0xEFFF0063
  ISDSC_CANNOT_REMOVE_LEADING_CONNECTION       0xEFFF0064
  ISDSC_RESTRICTED_BY_GROUP_POLICY             0xEFFF0065
  ISDSC_ISNS_FIREWALL_BLOCKED                  0xEFFF0066

flag ISCSI_SECURITY_FLAGS UINT64
  ISCSI_SECURITY_FLAG_VALID                    0x00000001
  ISCSI_SECURITY_FLAG_IKE_IPSEC_ENABLED        0x00000002
  ISCSI_SECURITY_FLAG_MAIN_MODE_ENABLED        0x00000004
  ISCSI_SECURITY_FLAG_AGGRESSIVE_MODE_ENABLED  0x00000008
  ISCSI_SECURITY_FLAG_PFS_ENABLED              0x00000010
  ISCSI_SECURITY_FLAG_TRANSPORT_MODE_PREFERRED 0x00000020
  ISCSI_SECURITY_FLAG_TUNNEL_MODE_PREFERRED    0x00000040

flag ISCSI_TARGET_FLAGS UINT
  ISCSI_TARGET_FLAG_HIDE_STATIC_TARGET       0x00000002
  ISCSI_TARGET_FLAG_MERGE_TARGET_INFORMATION 0x00000004

struct ISCSI_TARGET_PORTAL_INFO_EX
  InitiatorName "TCHAR [MAX_ISCSI_HBANAME_LEN]"
  InitiatorPortNumber ULONG
  SymbolicName "TCHAR [MAX_ISCSI_PORTAL_NAME_LEN]"
  Address "TCHAR [MAX_ISCSI_PORTAL_ADDRESS_LEN]"
  Socket USHORT
  SecurityFlags ISCSI_SECURITY_FLAGS
  LoginOptions ISCSI_LOGIN_OPTIONS

pointer PISCSI_TARGET_PORTAL_INFO_EX ISCSI_TARGET_PORTAL_INFO_EX

enum TARGET_INFORMATION_CLASS UINT
  ProtocolType             0
  TargetAlias              1
  DiscoveryMechanisms      2
  PortalGroups             3
  PersistentTargetMappings 4
  InitiatorName            5
  TargetFlags              6
  LoginOptions             7

struct SCSI_LUN_LIST
  OSLUN ULONG
  TargetLUN ULONGLONG

pointer PSCSI_LUN_LIST SCSI_LUN_LIST

struct ISCSI_TARGET_MAPPING
  InitiatorName "TCHAR [MAX_ISCSI_HBANAME_LEN]"
  TargetName "TCHAR [MAX_ISCSI_NAME_LEN + 1]"
  OSDeviceName "TCHAR [MAX_PATH]"
  SessionId ISCSI_UNIQUE_SESSION_ID
  OSBusNumber ULONG
  OSTargetNumber ULONG
  LUNCount ULONG
  LUNList PSCSI_LUN_LIST count=LUNCount

pointer PISCSI_TARGET_MAPPING ISCSI_TARGET_MAPPING

struct SCSI_ADDRESS
  Length ULONG
  PortNumber UCHAR
  PathId UCHAR
  TargetId UCHAR
  Lun UCHAR

enum DEVICE_TYPE DWORD
  FILE_DEVICE_BEEP                0x00000001
  FILE_DEVICE_CD_ROM              0x00000002
  FILE_DEVICE_CD_ROM_FILE_SYSTEM  0x00000003
  FILE_DEVICE_CONTROLLER          0x00000004
  FILE_DEVICE_DATALINK            0x00000005
  FILE_DEVICE_DFS                 0x00000006
  FILE_DEVICE_DISK                0x00000007
  FILE_DEVICE_DISK_FILE_SYSTEM    0x00000008
  FILE_DEVICE_FILE_SYSTEM         0x00000009
  FILE_DEVICE_INPORT_PORT         0x0000000a
  FILE_DEVICE_KEYBOARD            0x0000000b
  FILE_DEVICE_MAILSLOT            0x0000000c
  FILE_DEVICE_MIDI_IN             0x0000000d
  FILE_DEVICE_MIDI_OUT            0x0000000e
  FILE_DEVICE_MOUSE               0x0000000f
  FILE_DEVICE_MULTI_UNC_PROVIDER  0x00000010
  FILE_DEVICE_NAMED_PIPE          0x00000011
  FILE_DEVICE_NETWORK             0x00000012
  FILE_DEVICE_NETWORK_BROWSER     0x00000013
  FILE_DEVICE_NETWORK_FILE_SYSTEM 0x00000014
  FILE_DEVICE_NULL                0x00000015
  FILE_DEVICE_PARALLEL_PORT       0x00000016
  FILE_DEVICE_PHYSICAL_NETCARD    0x00000017
  FILE_DEVICE_PRINTER             0x00000018
  FILE_DEVICE_SCANNER             0x00000019
  FILE_DEVICE_SERIAL_MOUSE_PORT   0x0000001a
  FILE_DEVICE_SERIAL_PORT         0x0000001b
  FILE_DEVICE_SCREEN              0x0000001c
  FILE_DEVICE_SOUND               0x0000001d
  FILE_DEVICE_STREAMS             0x0000001e
  FILE_DEVICE_TAPE                0x0000001f
  FILE_DEVICE_TAPE_FILE_SYSTEM    0x00000020
  FILE_DEVICE_TRANSPORT           0x00000021
  FILE_DEVICE_UNKNOWN             0x00000022
  FILE_DEVICE_VIDEO               0x00000023
  FILE_DEVICE_VIRTUAL_DISK        0x00000024
  FILE_DEVICE_WAVE_IN             0x00000025
  FILE_DEVICE_WAVE_OUT            0x00000026
  FILE_DEVICE_8042_PORT           0x00000027
  FILE_DEVICE_NETWORK_REDIRECTOR  0x00000028
  FILE_DEVICE_BATTERY             0x00000029
  FILE_DEVICE_BUS_EXTENDER        0x0000002a
  FILE_DEVICE_MODEM               0x0000002b
  FILE_DEVICE_VDM                 0x0000002c
  FILE_DEVICE_MASS_STORAGE        0x0000002d
  FILE_DEVICE_SMB                 0x0000002e
  FILE_DEVICE_KS                  0x0000002f
  FILE_DEVICE_CHANGER             0x00000030
  FILE_DEVICE_SMARTCARD           0x00000031
  FILE_DEVICE_ACPI                0x00000032
  FILE_DEVICE_DVD                 0x00000033
  FILE_DEVICE_FULLSCREEN_VIDEO    0x00000034
  FILE_DEVICE_DFS_FILE_SYSTEM     0x00000035
  FILE_DEVICE_DFS_VOLUME          0x00000036
  FILE_DEVICE_SERENUM             0x00000037
  FILE_DEVICE_TERMSRV             0x00000038
  FILE_DEVICE_KSEC                0x00000039
  FILE_DEVICE_FIPS                0x0000003A
  FILE_DEVICE_INFINIBAND          0x0000003B
  FILE_DEVICE_VMBUS               0x0000003E
  FILE_DEVICE_CRYPT_PROVIDER      0x0000003F
  FILE_DEVICE_WPD                 0x00000040
  FILE_DEVICE_BLUETOOTH           0x00000041
  FILE_DEVICE_MT_COMPOSITE        0x00000042
  FILE_DEVICE_MT_TRANSPORT        0x00000043
  FILE_DEVICE_BIOMETRIC           0x00000044
  FILE_DEVICE_PMI                 0x00000045

struct STORAGE_DEVICE_NUMBER
  DeviceType DEVICE_TYPE
  DeviceNumber DWORD
  PartitionNumber DWORD

struct ISCSI_DEVICE_ON_SESSION
  InitiatorName "TCHAR [MAX_ISCSI_HBANAME_LEN]"
  TargetName "TCHAR [MAX_ISCSI_NAME_LEN + 1]"
  ScsiAddress SCSI_ADDRESS
  DeviceInterfaceType GUID
  DeviceInterfaceName "TCHAR [MAX_PATH]"
  LegacyName "TCHAR [MAX_PATH]"
  StorageDeviceNumber STORAGE_DEVICE_NUMBER
  DeviceInstance DWORD

pointer PISCSI_DEVICE_ON_SESSION ISCSI_DEVICE_ON_SESSION

struct ISCSI_TARGET_PORTAL
  SymbolicName "TCHAR [MAX_ISCSI_PORTAL_NAME_LEN]"
  Address "TCHAR [MAX_ISCSI_PORTAL_ADDRESS_LEN]"
  Socket USHORT

pointer PISCSI_TARGET_PORTAL ISCSI_TARGET_PORTAL

array "ISCSI_TARGET_PORTAL [1]" base=ISCSI_TARGET_PORTAL count=1

struct ISCSI_TARGET_PORTAL_GROUP
  Count ULONG
  Portals "ISCSI_TARGET_PORTAL [1]"

pointer PISCSI_TARGET_PORTAL_GROUP ISCSI_TARGET_PORTAL_GROUP

struct ISCSI_TARGET_PORTAL_INFO
  InitiatorName "TCHAR [MAX_ISCSI_HBANAME_LEN]"
  InitiatorPortNumber ULONG
  SymbolicName "TCHAR [MAX_ISCSI_PORTAL_NAME_LEN]"
  Address "TCHAR [MAX_ISCSI_PORTAL_ADDRESS_LEN]"
  Socket USHORT

pointer PISCSI_TARGET_PORTAL_INFO ISCSI_TARGET_PORTAL_INFO

struct ISCSI_CONNECTION_INFO
  ConnectionId ISCSI_UNIQUE_CONNECTION_ID
  InitiatorAddress PTCHAR
  TargetAddress PTCHAR
  InitiatorSocket USHORT
  TargetSocket USHORT
  CID "UCHAR [2]"

pointer PISCSI_CONNECTION_INFO ISCSI_CONNECTION_INFO

struct ISCSI_SESSION_INFO
  SessionId ISCSI_UNIQUE_SESSION_ID
  InitiatorName PTCHAR
  TargetNodeName PTCHAR
  TargetName PTCHAR
  ISID "UCHAR [6]"
  TSID "UCHAR [2]"
  ConnectionCount ULONG
  Connections PISCSI_CONNECTION_INFO count=ConnectionCount

pointer PISCSI_SESSION_INFO ISCSI_SESSION_INFO

struct PERSISTENT_ISCSI_LOGIN_INFO
  TargetName "TCHAR [MAX_ISCSI_NAME_LEN + 1]"
  IsInformationalSession BOOLEAN
  InitiatorInstance "TCHAR [MAX_ISCSI_HBANAME_LEN]"
  InitiatorPortNumber ULONG
  TargetPortal ISCSI_TARGET_PORTAL
  SecurityFlags ISCSI_SECURITY_FLAGS
  Mappings PISCSI_TARGET_MAPPING
  LoginOptions ISCSI_LOGIN_OPTIONS

pointer PPERSISTENT_ISCSI_LOGIN_INFO PERSISTENT_ISCSI_LOGIN_INFO

enum IKE_AUTHENTICATION_METHOD UINT
  IKE_AUTHENTICATION_PRESHARED_KEY_METHOD 1

enum IKE_IDENTIFICATION_PAYLOAD_TYPE UCHAR
  ID_IPV4_ADDR 1
  ID_FQDN      2
  ID_USER_FQDN 3
  ID_IPV6_ADDR 5

struct IKE_AUTHENTICATION_PRESHARED_KEY
  SecurityFlags ISCSI_SECURITY_FLAGS
  IdType IKE_IDENTIFICATION_PAYLOAD_TYPE
  IdLengthInBytes ULONG
  Id PUCHAR length=IdLengthInBytes
  KeyLengthInBytes ULONG
  Key PUCHAR length=KeyLengthInBytes

union [IKE_AUTHENTICATION_INFORMATION_u] display=union
  PsKey IKE_AUTHENTICATION_PRESHARED_KEY

struct IKE_AUTHENTICATION_INFORMATION
  AuthMethod IKE_AUTHENTICATION_METHOD
  AuthMethod [IKE_AUTHENTICATION_INFORMATION_u]

pointer PIKE_AUTHENTICATION_INFORMATION IKE_AUTHENTICATION_INFORMATION

func AddISNSServer bothCharset
  ISDSC_STATUS
  Address PTCHAR

func AddIScsiConnection bothCharset
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  Reserved PVOID
  InitiatorPortNumber ULONG
  TargetPortal PISCSI_TARGET_PORTAL
  SecurityFlags ISCSI_SECURITY_FLAGS
  LoginOptions PISCSI_LOGIN_OPTIONS
  KeySize ULONG
  Key PCHAR
  ConnectionId PISCSI_UNIQUE_CONNECTION_ID

func AddIScsiSendTargetPortal bothCharset
  ISDSC_STATUS
  InitiatorName PTCHAR
  InitiatorPortNumber ULONG
  LoginOptions PISCSI_LOGIN_OPTIONS
  SecurityFlags ISCSI_SECURITY_FLAGS
  Portal PISCSI_TARGET_PORTAL

func AddIScsiStaticTarget bothCharset
  ISDSC_STATUS
  TargetName PTCHAR
  TargetAlias PTCHAR
  TargetFlags ISCSI_TARGET_FLAGS
  Persist BOOLEAN
  Mappings PISCSI_TARGET_MAPPING
  LoginOptions PISCSI_LOGIN_OPTIONS
  PortalGroup PISCSI_TARGET_PORTAL_GROUP

func AddPersistentIScsiDevice bothCharset
  ISDSC_STATUS
  VolumePath PTCHAR

func AddRadiusServer bothCharset
  ISDSC_STATUS
  Address PWCHAR

func ClearPersistentIScsiDevices
  ISDSC_STATUS

func GetDevicesForIScsiSession bothCharset
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  DeviceCount ULONG*
  Devices PISCSI_DEVICE_ON_SESSION postCount=DeviceCount

func GetIScsiIKEInfo bothCharset
  ISDSC_STATUS
  InitiatorName PTCHAR
  PortNumber ULONG
  Reserved PULONG
  AuthInfo PIKE_AUTHENTICATION_INFORMATION

func GetIScsiInitiatorNodeName bothCharset
  ISDSC_STATUS
  InitiatorNodeName PTCHAR outputOnly

func GetIScsiSessionList bothCharset
  ISDSC_STATUS
  BufferSize ULONG*
  SessionCount ULONG*
  SessionInfo PISCSI_SESSION_INFO postCount=SessionCount

func GetIScsiTargetInformation bothCharset
  ISDSC_STATUS
  TargetName PTCHAR
  DiscoveryMechanism PTCHAR
  InfoClass TARGET_INFORMATION_CLASS
  BufferSize PULONG
  Buffer PVOID postLength=BufferSize

func GetIScsiVersionInformation
  ISDSC_STATUS
  VersionInfo PISCSI_VERSION_INFO

func LoginIScsiTarget bothCharset
  ISDSC_STATUS
  TargetName PTCHAR
  IsInformationalSession BOOLEAN
  InitiatorName PTCHAR
  InitiatorPortNumber ULONG
  TargetPortal PISCSI_TARGET_PORTAL
  SecurityFlags ISCSI_SECURITY_FLAGS
  Mappings PISCSI_TARGET_MAPPING
  LoginOptions PISCSI_LOGIN_OPTIONS
  KeySize ULONG
  Key PCHAR
  IsPersistent BOOLEAN
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  UniqueConnectionId PISCSI_UNIQUE_CONNECTION_ID

func LogoutIScsiTarget
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID

func RefreshISNSServer bothCharset
  ISDSC_STATUS
  Address PTCHAR

func RefreshIScsiSendTargetPortal bothCharset
  ISDSC_STATUS
  InitiatorInstance PTCHAR
  InitiatorPortNumber ULONG
  Portal PISCSI_TARGET_PORTAL

func RemoveISNSServer bothCharset
  ISDSC_STATUS
  Address PTCHAR

func RemoveIScsiConnection
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  UniqueConnectionId PISCSI_UNIQUE_CONNECTION_ID

func RemoveIScsiPersistentTarget bothCharset
  ISDSC_STATUS
  InitiatorInstance PTCHAR
  InitiatorPortNumber ULONG
  TargetName PTCHAR
  Portal PISCSI_TARGET_PORTAL

func RemoveIScsiSendTargetPortal bothCharset
  ISDSC_STATUS
  InitiatorInstance PTCHAR
  InitiatorPortNumber ULONG
  Portal PISCSI_TARGET_PORTAL

func RemoveIScsiStaticTarget bothCharset
  ISDSC_STATUS
  TargetName PTCHAR

func RemovePersistentIScsiDevice bothCharset
  ISDSC_STATUS
  VolumePath PTCHAR

func RemoveRadiusServer bothCharset
  ISDSC_STATUS
  Address PTCHAR

func ReportActiveIScsiTargetMappings bothCharset
  ISDSC_STATUS
  BufferSize PULONG
  MappingCount PULONG
  Mappings PISCSI_TARGET_MAPPING postCount=MappingCount

func ReportISNSServerList bothCharset
  ISDSC_STATUS
  BufferSizeInChar PULONG
  Buffer PTCHAR

func ReportIScsiInitiatorList bothCharset
  ISDSC_STATUS
  BufferSize ULONG*
  Buffer PTCHAR

func ReportIScsiPersistentLogins bothCharset
  ISDSC_STATUS
  Count ULONG*
  PersistentLoginInfo PPERSISTENT_ISCSI_LOGIN_INFO count=Count
  BufferSizeInBytes PULONG

func ReportIScsiSendTargetPortals bothCharset
  ISDSC_STATUS
  PortalCount PULONG
  PortalInfo PISCSI_TARGET_PORTAL_INFO count=PortalCount

func ReportIScsiSendTargetPortalsEx bothCharset
  ISDSC_STATUS
  PortalCount PULONG
  PortalInfoSize PULONG
  PortalInfo PISCSI_TARGET_PORTAL_INFO_EX count=PortalCount

func ReportIScsiTargets bothCharset
  ISDSC_STATUS
  ForceUpdate BOOLEAN
  BufferSize PULONG
  Buffer PTCHAR outputOnly

func ReportIScsiTargetPortals bothCharset
  ISDSC_STATUS
  InitiatorName PWCHAR
  TargetName PWCHAR
  TargetPortalTag PUSHORT
  ElementCount PULONG
  Portals PISCSI_TARGET_PORTAL count=ElementCount

func ReportPersistentIScsiDevices bothCharset
  ISDSC_STATUS
  BufferSizeInChar PULONG
  Buffer PTCHAR

func ReportRadiusServerList bothCharset
  ISDSC_STATUS
  BufferSizeInChar PULONG
  Buffer PTCHAR

func SendScsiInquiry
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID*
  Lun ULONGLONG
  EvpdCmddt UCHAR
  PageCode UCHAR
  ScsiStatus PUCHAR*
  ReponseSize PULONG*
  ReponseBuffer PUCHAR
  SenseSize PULONG*
  SenseBuffer PUCHAR

func SendScsiReadCapacity
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  Lun ULONGLONG
  ScsiStatus PUCHAR*
  ResponseSize PULONG*
  ResponseBuffer PUCHAR
  SenseSize PULONG*
  SenseBuffer PUCHAR

func SendScsiReportLuns
  ISDSC_STATUS
  UniqueSessionId PISCSI_UNIQUE_SESSION_ID
  ScsiStatus PUCHAR*
  ResponseSize PULONG*
  ResponseBuffer PUCHAR
  SenseSize PULONG*
  SenseBuffer PUCHAR

func SetIScsiGroupPresharedKey
  ISDSC_STATUS
  KeyLength ULONG
  Key PUCHAR
  Persist BOOLEAN

func SetIScsiIKEInfo bothCharset
  ISDSC_STATUS
  InitiatorName PTCHAR
  PortNumber ULONG
  AuthInfo PIKE_AUTHENTICATION_INFORMATION
  Persist BOOLEAN

func SetIScsiInitiatorCHAPSharedSecret
  ISDSC_STATUS
  SharedSecretLength ULONG
  SharedSecret PUCHAR

func SetIScsiInitiatorRADIUSSharedSecret
  ISDSC_STATUS
  SharedSecretLength ULONG
  SharedSecret PUCHAR

func SetIScsiInitiatorNodeName bothCharset
  ISDSC_STATUS
  InitiatorNodeName PTCHAR

func SetIScsiTunnelModeOuterAddress bothCharset
  ISDSC_STATUS
  InitiatorName PTCHAR
  InitiatorPortNumber ULONG
  DestinationAddress PTCHAR
  OuterModeAddress PTCHAR
  Persist BOOLEAN

func SetupPersistentIScsiDevices
  ISDSC_STATUS

