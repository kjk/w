include Headers\windows.h.txt
include Headers\cryptography.h.txt

dll Cryptxml.dll callingConvention=STDCALL errorFunc=GetLastError onlineHelp=MSDN
category "Security and Identity/Cryptography/CryptXML"
alias HCRYPTXML LPVOID

pointer HCRYPTXML* HCRYPTXML

alias PFN_CRYPT_XML_DATA_PROVIDER_READ LPVOID

alias PFN_CRYPT_XML_DATA_PROVIDER_CLOSE LPVOID

alias PFN_CRYPT_XML_WRITE_CALLBACK LPVOID

alias PFN_CRYPT_XML_CREATE_TRANSFORM LPVOID

struct CRYPT_XML_DATA_BLOB
  cbData ULONG
  pbData BYTE* length=cbData

enum CRYPT_XML_CHARSET UINT
  CRYPT_XML_CHARSET_AUTO    0
  CRYPT_XML_CHARSET_UTF8    1
  CRYPT_XML_CHARSET_UTF16LE 2
  CRYPT_XML_CHARSET_UTF16BE 3

struct CRYPT_XML_BLOB
  dwCharset CRYPT_XML_CHARSET
  cbData ULONG
  pbData BYTE* length=cbData

pointer "const PCRYPT_XML_BLOB" CRYPT_XML_BLOB

pointer "const CRYPT_XML_BLOB*" CRYPT_XML_BLOB

pointer CRYPT_XML_BLOB* CRYPT_XML_BLOB

enum [CRYPT_XML_KEY_VALUE_TYPE] DWORD display=DWORD
  CRYPT_XML_KEY_VALUE_TYPE_DSA    0x00000001
  CRYPT_XML_KEY_VALUE_TYPE_RSA    0x00000002
  CRYPT_XML_KEY_VALUE_TYPE_ECDSA  0x00000003
  CRYPT_XML_KEY_VALUE_TYPE_CUSTOM 0x00000004

struct CRYPT_XML_KEY_DSA_KEY_VALUE
  P CRYPT_XML_DATA_BLOB
  Q CRYPT_XML_DATA_BLOB
  G CRYPT_XML_DATA_BLOB
  Y CRYPT_XML_DATA_BLOB
  J CRYPT_XML_DATA_BLOB
  Seed CRYPT_XML_DATA_BLOB
  Counter CRYPT_XML_DATA_BLOB

struct CRYPT_XML_KEY_RSA_KEY_VALUE
  Modulus CRYPT_XML_DATA_BLOB
  Exponent CRYPT_XML_DATA_BLOB

struct CRYPT_XML_KEY_ECDSA_KEY_VALUE
  wszNamedCurve LPCWSTR
  X CRYPT_XML_DATA_BLOB
  Y CRYPT_XML_DATA_BLOB
  ExplicitPara CRYPT_XML_BLOB

union [CRYPT_XML_KEY_VALUE_u] display=union
  DSAKeyValue CRYPT_XML_KEY_DSA_KEY_VALUE
  RSAKeyValue CRYPT_XML_KEY_RSA_KEY_VALUE
  ECDSAKeyValue CRYPT_XML_KEY_ECDSA_KEY_VALUE
  Custom CRYPT_XML_BLOB

struct CRYPT_XML_KEY_VALUE
  dwType [CRYPT_XML_KEY_VALUE_TYPE]
   [CRYPT_XML_KEY_VALUE_u]

pointer CRYPT_XML_KEY_VALUE* CRYPT_XML_KEY_VALUE

enum [CRYPT_XML_X509DATA_TYPE] DWORD display=DWORD
  CRYPT_XML_X509DATA_TYPE_ISSUER_SERIAL 0x00000001
  CRYPT_XML_X509DATA_TYPE_SKI           0x00000002
  CRYPT_XML_X509DATA_TYPE_SUBJECT_NAME  0x00000003
  CRYPT_XML_X509DATA_TYPE_CERTIFICATE   0x00000004
  CRYPT_XML_X509DATA_TYPE_CRL           0x00000005
  CRYPT_XML_X509DATA_TYPE_CUSTOM        0x00000006

struct CRYPT_XML_ISSUER_SERIAL
  wszIssuer LPCWSTR
  wszSerial LPCWSTR

union [CRYPT_XML_X509DATA_ITEM_u] display=union
  IssuerSerial CRYPT_XML_ISSUER_SERIAL
  SKI CRYPT_XML_DATA_BLOB
  wszSubjectName LPCWSTR
  Certificate CRYPT_XML_DATA_BLOB
  CRL CRYPT_XML_DATA_BLOB
  Custom CRYPT_XML_BLOB

struct CRYPT_XML_X509DATA_ITEM
  dwType [CRYPT_XML_X509DATA_TYPE]
   [CRYPT_XML_X509DATA_ITEM_u]

pointer CRYPT_XML_X509DATA_ITEM* CRYPT_XML_X509DATA_ITEM

struct CRYPT_XML_X509DATA
  cX509Data UINT
  rgX509Data CRYPT_XML_X509DATA_ITEM* count=cX509Data

enum [CRYPT_XML_KEYINFO_TYPE] DWORD display=DWORD
  CRYPT_XML_KEYINFO_TYPE_KEYNAME   0x00000001
  CRYPT_XML_KEYINFO_TYPE_KEYVALUE  0x00000002
  CRYPT_XML_KEYINFO_TYPE_RETRIEVAL 0x00000003
  CRYPT_XML_KEYINFO_TYPE_X509DATA  0x00000004
  CRYPT_XML_KEYINFO_TYPE_CUSTOM    0x00000005

union [CRYPT_XML_KEY_INFO_ITEM_u] display=union
  wszKeyName LPCWSTR
  KeyValue CRYPT_XML_KEY_VALUE
  RetrievalMethod CRYPT_XML_BLOB
  X509Data CRYPT_XML_X509DATA
  Custom CRYPT_XML_BLOB

struct CRYPT_XML_KEY_INFO_ITEM
  dwType [CRYPT_XML_KEYINFO_TYPE]
   [CRYPT_XML_KEY_INFO_ITEM_u]

pointer CRYPT_XML_KEY_INFO_ITEM* CRYPT_XML_KEY_INFO_ITEM

struct CRYPT_XML_ALGORITHM
  cbSize ULONG
  wszAlgorithm LPCWSTR
  Encoded CRYPT_XML_BLOB

pointer CRYPT_XML_ALGORITHM* CRYPT_XML_ALGORITHM

pointer "const CRYPT_XML_ALGORITHM*" CRYPT_XML_ALGORITHM

enum CRYPT_XML_PROPERTY_ID UINT
  CRYPT_XML_PROPERTY_MAX_HEAP_SIZE      1
  CRYPT_XML_PROPERTY_SIGNATURE_LOCATION 2
  CRYPT_XML_PROPERTY_MAX_SIGNATURES     3
  CRYPT_XML_PROPERTY_DOC_DECLARATION    4
  CRYPT_XML_PROPERTY_XML_OUTPUT_CHARSET 5

struct CRYPT_XML_PROPERTY
  dwPropId CRYPT_XML_PROPERTY_ID
  pvValue "const void*" length=cbValue
  cbValue ULONG

pointer CRYPT_XML_PROPERTY* CRYPT_XML_PROPERTY

alias "const CRYPT_XML_PROPERTY*" CRYPT_XML_PROPERTY*

struct CRYPT_XML_REFERENCE
  cbSize ULONG
  hReference HCRYPTXML
  wszId LPCWSTR
  wszUri LPCWSTR
  wszType LPCWSTR
  DigestMethod CRYPT_XML_ALGORITHM
  DigestValue CRYPT_DATA_BLOB
  cTransform ULONG
  rgTransform CRYPT_XML_ALGORITHM* count=cTransform

pointer PCRYPT_XML_REFERENCE CRYPT_XML_REFERENCE

pointer PCRYPT_XML_REFERENCE* PCRYPT_XML_REFERENCE

pointer CRYPT_XML_REFERENCE* CRYPT_XML_REFERENCE

pointer "const CRYPT_XML_REFERENCE**" CRYPT_XML_REFERENCE*

struct CRYPT_XML_REFERENCES
  cReference ULONG
  rgpReference PCRYPT_XML_REFERENCE* count=cReference

struct CRYPT_XML_OBJECT
  cbSize ULONG
  hObject HCRYPTXML
  wszId LPCWSTR
  wszMimeType LPCWSTR
  wszEncoding LPCWSTR
  Manifest CRYPT_XML_REFERENCES
  Encoded CRYPT_XML_BLOB

pointer CRYPT_XML_OBJECT* CRYPT_XML_OBJECT

pointer PCRYPT_XML_OBJECT CRYPT_XML_OBJECT

pointer PCRYPT_XML_OBJECT* PCRYPT_XML_OBJECT

pointer "const CRYPT_XML_OBJECT**" CRYPT_XML_OBJECT*

struct CRYPT_XML_DATA_PROVIDER
  pvCallbackState void*
  cbBufferSize ULONG
  pfnRead PFN_CRYPT_XML_DATA_PROVIDER_READ
  pfnClose PFN_CRYPT_XML_DATA_PROVIDER_CLOSE

pointer CRYPT_XML_DATA_PROVIDER* CRYPT_XML_DATA_PROVIDER

struct CRYPT_XML_ALGORITHM_INFO
  cbSize DWORD
  wszAlgorithmURI WCHAR*
  wszName WCHAR*
  dwGroupId DWORD
  wszCNGAlgid WCHAR*
  wszCNGExtraAlgid WCHAR*
  dwSignFlags DWORD
  dwVerifyFlags DWORD
  pvPaddingInfo void*
  pvExtraInfo void*

pointer CRYPT_XML_ALGORITHM_INFO* CRYPT_XML_ALGORITHM_INFO

pointer CRYPT_XML_ALGORITHM_INFO** CRYPT_XML_ALGORITHM_INFO*

struct CRYPT_XML_TRANSFORM_INFO
  cbSize ULONG
  wszAlgorithm LPCWSTR
  cbBufferSize ULONG
  dwFlags DWORD
  pfnCreateTransform PFN_CRYPT_XML_CREATE_TRANSFORM

pointer PCRYPT_XML_TRANSFORM_INFO CRYPT_XML_TRANSFORM_INFO

pointer PCRYPT_XML_TRANSFORM_INFO* PCRYPT_XML_TRANSFORM_INFO

struct CRYPT_XML_TRANSFORM_CHAIN_CONFIG
  cbSize ULONG
  cTransformInfo ULONG
  rgpTransformInfo PCRYPT_XML_TRANSFORM_INFO* count=cTransformInfo

pointer CRYPT_XML_TRANSFORM_CHAIN_CONFIG* CRYPT_XML_TRANSFORM_CHAIN_CONFIG

pointer CRYPT_XML_TRANSFORM_CHAIN_CONFIG** CRYPT_XML_TRANSFORM_CHAIN_CONFIG*

struct CRYPT_XML_SIGNED_INFO
  cbSize ULONG
  wszId LPCWSTR
  Canonicalization CRYPT_XML_ALGORITHM
  SignatureMethod CRYPT_XML_ALGORITHM
  cReference ULONG
  rgpReference PCRYPT_XML_REFERENCE* count=cReference
  Encoded CRYPT_XML_BLOB

struct CRYPT_XML_KEY_INFO
  cbSize ULONG
  wszId LPCWSTR
  cKeyInfo UINT
  rgKeyInfo CRYPT_XML_KEY_INFO_ITEM* count=cKeyInfo
  hVerifyKey BCRYPT_KEY_HANDLE

pointer CRYPT_XML_KEY_INFO* CRYPT_XML_KEY_INFO

struct CRYPT_XML_SIGNATURE
  cbSize ULONG
  hSignature HCRYPTXML
  wszId LPCWSTR
  SignedInfo CRYPT_XML_SIGNED_INFO
  SignatureValue CRYPT_DATA_BLOB
  pKeyInfo CRYPT_XML_KEY_INFO*
  cObject ULONG
  rgpObject PCRYPT_XML_OBJECT* count=cObject

pointer PCRYPT_XML_SIGNATURE CRYPT_XML_SIGNATURE

pointer PCRYPT_XML_SIGNATURE* PCRYPT_XML_SIGNATURE

pointer "const CRYPT_XML_SIGNATURE**" PCRYPT_XML_SIGNATURE

struct CRYPT_XML_DOC_CTXT
  cbSize ULONG
  hDocCtxt HCRYPTXML
  pTransformsConfig CRYPT_XML_TRANSFORM_CHAIN_CONFIG*
  cSignature ULONG
  rgpSignature PCRYPT_XML_SIGNATURE* count=cSignature

pointer CRYPT_XML_DOC_CTXT* CRYPT_XML_DOC_CTXT

pointer "const CRYPT_XML_DOC_CTXT**" CRYPT_XML_DOC_CTXT*

struct CRYPT_XML_STATUS
  cbSize ULONG
  dwErrorStatus DWORD
  dwInfoStatus DWORD

pointer CRYPT_XML_STATUS* CRYPT_XML_STATUS

enum CRYPT_XML_KEYINFO_SPEC UINT
  CRYPT_XML_KEYINFO_SPEC_NONE    0
  CRYPT_XML_KEYINFO_SPEC_ENCODED 1
  CRYPT_XML_KEYINFO_SPEC_PARAM   2

func CryptXmlCreateReference
  HRESULT
  hCryptXml HCRYPTXML
  dwFlags DWORD
  wszId LPCWSTR
  wszURI LPCWSTR
  wszType LPCWSTR
  pDigestMethod "const CRYPT_XML_ALGORITHM*"
  cTransform ULONG
  rgTransform "const CRYPT_XML_ALGORITHM*" count=cTransform
  phReference HCRYPTXML*

func CryptXmlAddObject
  HRESULT
  hSignatureOrObject HCRYPTXML
  dwFlags DWORD
  rgProperty "const CRYPT_XML_PROPERTY*" count=cProperty
  cProperty ULONG
  pEncoded "const PCRYPT_XML_BLOB"
  ppObject "const CRYPT_XML_OBJECT**"

func CryptXmlClose
  HRESULT
  hCryptXml HCRYPTXML

func CryptXmlDigestReference
  HRESULT
  hReference HCRYPTXML
  dwFlags DWORD
  pDataProviderIn CRYPT_XML_DATA_PROVIDER*

func CryptXmlEncode
  HRESULT
  hCryptXml HCRYPTXML
  dwCharset CRYPT_XML_CHARSET
  rgProperty "const CRYPT_XML_PROPERTY*" count=cProperty
  cProperty ULONG
  pvCallbackState void*
  pfnWrite PFN_CRYPT_XML_WRITE_CALLBACK

func CryptXmlGetAlgorithmInfo
  HRESULT
  pXmlAlgorithm "const CRYPT_XML_ALGORITHM*"
  dwFlags DWORD
  ppAlgInfo CRYPT_XML_ALGORITHM_INFO**

func CryptXmlGetDocContext
  HRESULT
  hCryptXml HCRYPTXML
  ppStruct "const CRYPT_XML_DOC_CTXT**"

func CryptXmlGetReference
  HRESULT
  HCRYPTXML HCRYPTXML
  ppStruct "const CRYPT_XML_REFERENCE**"

func CryptXmlGetSignature
  HRESULT
  hCryptXml HCRYPTXML
  ppStruct "const CRYPT_XML_SIGNATURE**"

func CryptXmlGetStatus
  HRESULT
  hCryptXml HCRYPTXML
  pStatus CRYPT_XML_STATUS*

func CryptXmlGetTransforms
  HRESULT
  ppConfig CRYPT_XML_TRANSFORM_CHAIN_CONFIG**

func CryptXmlImportPublicKey
  HRESULT
  dwFlags DWORD
  pKeyValue CRYPT_XML_KEY_VALUE*
  phKey BCRYPT_KEY_HANDLE*

func CryptXmlOpenToEncode
  HRESULT
  pConfig CRYPT_XML_TRANSFORM_CHAIN_CONFIG*
  dwFlags DWORD
  wszId LPCWSTR
  rgProperty CRYPT_XML_PROPERTY* count=cProperty
  cProperty ULONG
  pEncoded CRYPT_XML_BLOB*
  phSignature HCRYPTXML*

func CryptXmlOpenToDecode
  HRESULT
  pConfig CRYPT_XML_TRANSFORM_CHAIN_CONFIG*
  dwFlags DWORD
  rgProperty "const CRYPT_XML_PROPERTY*" count=cProperty
  cProperty ULONG
  pEncoded "const CRYPT_XML_BLOB*"
  phCryptXml HCRYPTXML

func CryptXmlSetHMACSecret
  HRESULT
  hSignature HCRYPTXML
  pbSecret "const BYTE*"
  cbSecret ULONG

func CryptXmlVerifySignature
  HRESULT
  hSignature HCRYPTXML
  hKey BCRYPT_KEY_HANDLE
  dwFlags DWORD

func CryptXmlSign
  HRESULT
  hSignature HCRYPTXML
  hKey HCRYPTPROV_OR_NCRYPT_KEY_HANDLE
  dwKeySpec DWORD
  dwFlags DWORD
  dwKeyInfoSpec CRYPT_XML_KEYINFO_SPEC
  pvKeyInfoSpec "const void*"
  pSignatureMethod "const CRYPT_XML_ALGORITHM*"
  pCanonicalization "const CRYPT_XML_ALGORITHM*"

