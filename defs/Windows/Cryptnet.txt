include Headers\windows.h.txt

dll Cryptnet.dll callingConvention=STDCALL errorFunc=GetLastError onlineHelp=MSDN
category "Security and Identity/Cryptography/Remote Object Retrieval"
alias HCRYPTASYNC HANDLE

struct CRYPT_URL_ARRAY
  cUrl DWORD
  rgwszUrl LPWSTR* count=cUrl

pointer PCRYPT_URL_ARRAY CRYPT_URL_ARRAY

struct CRYPT_URL_INFO
  cbSize DWORD
  dwSyncDeltaTime DWORD
  cGroup DWORD
  rgcGroupEntry DWORD* count=cGroup

pointer PCRYPT_URL_INFO CRYPT_URL_INFO

struct CRYPT_CREDENTIALS
  cbSize DWORD
  pszCredentialsOid LPCSTR
  pvCredentials LPVOID

pointer PCRYPT_CREDENTIALS CRYPT_CREDENTIALS

struct CRYPTNET_URL_CACHE_PRE_FETCH_INFO
  cbSize DWORD
  dwObjectType DWORD
  dwError DWORD
  dwReserved DWORD
  ThisUpdateTime FILETIME
  NextUpdateTime FILETIME
  PublishTime FILETIME

pointer PCRYPTNET_URL_CACHE_PRE_FETCH_INFO CRYPTNET_URL_CACHE_PRE_FETCH_INFO

struct CRYPTNET_URL_CACHE_FLUSH_INFO
  cbSize DWORD
  dwExemptSeconds DWORD
  ExpireTime FILETIME

pointer PCRYPTNET_URL_CACHE_FLUSH_INFO CRYPTNET_URL_CACHE_FLUSH_INFO

struct CRYPTNET_URL_CACHE_RESPONSE_INFO
  cbSize DWORD
  wResponseType WORD
  wResponseFlags WORD
  LastModifiedTime FILETIME
  dwMaxAge DWORD
  pwszETag LPCWSTR
  dwProxyId DWORD

pointer PCRYPTNET_URL_CACHE_RESPONSE_INFO CRYPTNET_URL_CACHE_RESPONSE_INFO

pointer PCRYPTNET_URL_CACHE_RESPONSE_INFO* PCRYPTNET_URL_CACHE_RESPONSE_INFO

struct CRYPT_RETRIEVE_AUX_INFO
  cbSize DWORD
  pLastSyncTime FILETIME*
  dwMaxUrlRetrievalByteCount DWORD
  pPreFetchInfo PCRYPTNET_URL_CACHE_PRE_FETCH_INFO
  pFlushInfo PCRYPTNET_URL_CACHE_FLUSH_INFO
  ppResponseInfo PCRYPTNET_URL_CACHE_RESPONSE_INFO*
  pwszCacheFileNamePrefix LPWSTR
  pftCacheResync LPFILETIME
  fProxyCacheRetrieval BOOL
  dwHttpStatusCode DWORD

pointer PCRYPT_RETRIEVE_AUX_INFO CRYPT_RETRIEVE_AUX_INFO

flag [CryptRetrievalFlags] DWORD display=DWORD
  CRYPT_RETRIEVE_MULTIPLE_OBJECTS      0x00000001
  CRYPT_CACHE_ONLY_RETRIEVAL           0x00000002
  CRYPT_WIRE_ONLY_RETRIEVAL            0x00000004
  CRYPT_DONT_CACHE_RESULT              0x00000008
  CRYPT_ASYNC_RETRIEVAL                0x00000010
  CRYPT_VERIFY_CONTEXT_SIGNATURE       0x00000020
  CRYPT_VERIFY_DATA_HASH               0x00000040
  CRYPT_STICKY_CACHE_RETRIEVAL         0x00001000
  CRYPT_LDAP_SCOPE_BASE_ONLY_RETRIEVAL 0x00002000
  CRYPT_OFFLINE_CHECK_RETRIEVAL        0x00004000
  CRYPT_LDAP_INSERT_ENTRY_ATTRIBUTE    0x00008000
  CRYPT_LDAP_SIGN_RETRIEVAL            0x00010000
  CRYPT_NO_AUTH_RETRIEVAL              0x00020000
  CRYPT_LDAP_AREC_EXCLUSIVE_RETRIEVAL  0x00040000
  CRYPT_AIA_RETRIEVAL                  0x00080000
  CRYPT_HTTP_POST_RETRIEVAL            0x00100000
  CRYPT_PROXY_CACHE_RETRIEVAL          0x00200000
  CRYPT_NOT_MODIFIED_RETRIEVAL         0x00400000

flag [CryptGetObjectUrlFlags] DWORD display=DWORD
  CRYPT_GET_URL_FROM_PROPERTY         0x00000001
  CRYPT_GET_URL_FROM_EXTENSION        0x00000002
  CRYPT_GET_URL_FROM_UNAUTH_ATTRIBUTE 0x00000004
  CRYPT_GET_URL_FROM_AUTH_ATTRIBUTE   0x00000008

func CryptGetObjectUrl
  BOOL
  pszUrlOid LPCSTR
  pvPara LPVOID
  dwFlags [CryptGetObjectUrlFlags]
  pUrlArray PCRYPT_URL_ARRAY
  pcbUrlArray DWORD*
  pUrlInfo PCRYPT_URL_INFO
  pcbUrlInfo DWORD*
  pvReserved LPVOID

func CryptRetrieveObjectByUrl bothCharset
  BOOL
  pszUrl LPCTSTR
  pszObjectOid LPCSTR
  dwRetrievalFlags [CryptRetrievalFlags]
  dwTimeout DWORD
  ppvObject LPVOID*
  hAsyncRetrieve HCRYPTASYNC
  pCredentials PCRYPT_CREDENTIALS
  pvVerify LPVOID
  pAuxInfo PCRYPT_RETRIEVE_AUX_INFO

