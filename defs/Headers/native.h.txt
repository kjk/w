include Headers\security.h.txt
include Headers\windows.h.txt

header
array "BYTE [IMAGE_SIZEOF_SHORT_NAME]" base=BYTE count=8

union [IMAGE_SECTION_HEADER_u] display=union
  PhysicalAddress DWORD
  VirtualSize DWORD

struct IMAGE_SECTION_HEADER
  Name "BYTE [IMAGE_SIZEOF_SHORT_NAME]"
  Misc [IMAGE_SECTION_HEADER_u]
  VirtualAddress DWORD
  SizeOfRawData DWORD
  PointerToRawData DWORD
  PointerToRelocations DWORD
  PointerToLinenumbers DWORD
  NumberOfRelocations WORD
  NumberOfLinenumbers WORD
  Characteristics DWORD

pointer PIMAGE_SECTION_HEADER IMAGE_SECTION_HEADER

pointer PIMAGE_SECTION_HEADER* PIMAGE_SECTION_HEADER

enum EVENT_TYPE UINT
  NotificationEvent    0
  SynchronizationEvent 1

flag [FILE_SHARE_MODE] DWORD display=DWORD
  FILE_SHARE_READ   0x00000001
  FILE_SHARE_WRITE  0x00000002
  FILE_SHARE_DELETE 0x00000004

flag [MemoryType] DWORD display=DWORD
  MEM_PRIVATE 0x20000
  MEM_MAPPED  0x40000
  MEM_IMAGE   0x1000000

flag [MemoryAllocationFlags] DWORD display=DWORD
  MEM_COMMIT      0x1000
  MEM_RESERVE     0x2000
  MEM_DECOMMIT    0x4000
  MEM_RELEASE     0x8000
  MEM_FREE        0x10000
  MEM_PRIVATE     0x20000
  MEM_MAPPED      0x40000
  MEM_RESET       0x80000
  MEM_TOP_DOWN    0x100000
  MEM_WRITE_WATCH 0x200000
  MEM_PHYSICAL    0x400000
  MEM_ROTATE      0x800000
  MEM_LARGE_PAGES 0x20000000
  MEM_4MB_PAGES   0x80000000

flag [MemoryProtection] DWORD display=DWORD
  PAGE_NOACCESS          0x01
  PAGE_READONLY          0x02
  PAGE_READWRITE         0x04
  PAGE_WRITECOPY         0x08
  PAGE_EXECUTE           0x10
  PAGE_EXECUTE_READ      0x20
  PAGE_EXECUTE_READWRITE 0x40
  PAGE_EXECUTE_WRITECOPY 0x80
  PAGE_GUARD             0x100
  PAGE_NOCACHE           0x200
  PAGE_WRITECOMBINE      0x400
  SEC_IMAGE              0x1000000
  SEC_RESERVE            0x4000000
  SEC_COMMIT             0x8000000
  SEC_NOCACHE            0x10000000
  SEC_WRITECOMBINE       0x40000000
  SEC_LARGE_PAGES        0x80000000

pointer [MemoryProtection*] [MemoryProtection] display=PDWORD

flag [NtVerType] DWORD display=DWORD
  VER_MINORVERSION     0x0000001
  VER_MAJORVERSION     0x0000002
  VER_BUILDNUMBER      0x0000004
  VER_PLATFORMID       0x0000008
  VER_SERVICEPACKMINOR 0x0000010
  VER_SERVICEPACKMAJOR 0x0000020
  VER_SUITENAME        0x0000040
  VER_PRODUCT_TYPE     0x0000080

flag [TOKEN_ACCESS_MASK] DWORD display=ACCESS_MASK
  TOKEN_ASSIGN_PRIMARY     0x0001
  TOKEN_DUPLICATE          0x0002
  TOKEN_IMPERSONATE        0x0004
  TOKEN_QUERY              0x0008
  TOKEN_QUERY_SOURCE       0x0010
  TOKEN_ADJUST_PRIVILEGES  0x0020
  TOKEN_ADJUST_GROUPS      0x0040
  TOKEN_ADJUST_DEFAULT     0x0080
  TOKEN_ADJUST_SESSIONID   0x0100
  DELETE                   0x00010000
  TOKEN_EXECUTE            0x20000
  TOKEN_READ               0x20008
  TOKEN_WRITE              0x200e0
  WRITE_DAC                0x00040000
  WRITE_OWNER              0x00080000
  STANDARD_RIGHTS_REQUIRED 0x000F0000
  TOKEN_ALL_ACCESS_P       0xf00ff
  TOKEN_ALL_ACCESS         0xf01ff
  SYNCHRONIZE              0x00100000
  STANDARD_RIGHTS_ALL      0x001F0000
  ACCESS_SYSTEM_SECURITY   0x01000000
  MAXIMUM_ALLOWED          0x02000000
  GENERIC_ALL              0x10000000
  GENERIC_EXECUTE          0x20000000
  GENERIC_WRITE            0x40000000
  GENERIC_READ             0x80000000

flag [ObjectAttributes] ULONG display=ULONG
  OBJ_INHERIT            0x00000002
  OBJ_PERMANENT          0x00000010
  OBJ_EXCLUSIVE          0x00000020
  OBJ_CASE_INSENSITIVE   0x00000040
  OBJ_OPENIF             0x00000080
  OBJ_OPENLINK           0x00000100
  OBJ_KERNEL_HANDLE      0x00000200
  OBJ_FORCE_ACCESS_CHECK 0x00000400
  OBJ_VALID_ATTRIBUTES   0x000007F2

struct OBJECT_ATTRIBUTES
  Length ULONG
  RootDirectory HANDLE
  ObjectName PUNICODE_STRING
  Attributes [ObjectAttributes]
  SecurityDescriptor PSECURITY_DESCRIPTOR
  SecurityQualityOfService PSECURITY_QUALITY_OF_SERVICE

pointer POBJECT_ATTRIBUTES OBJECT_ATTRIBUTES

pointer "OBJECT_ATTRIBUTES []" OBJECT_ATTRIBUTES

struct RTL_CRITICAL_SECTION_DEBUG
  Type WORD
  CreatorBackTraceIndex WORD
  CriticalSection LPVOID display=RTL_CRITICAL_SECTION*
  ProcessLocksList LIST_ENTRY
  EntryCount DWORD
  ContentionCount DWORD
  Flags DWORD
  CreatorBackTraceIndexHigh WORD
  SpareWORD WORD

pointer PRTL_CRITICAL_SECTION_DEBUG RTL_CRITICAL_SECTION_DEBUG

alias RTL_RESOURCE_DEBUG RTL_CRITICAL_SECTION_DEBUG

pointer PRTL_RESOURCE_DEBUG RTL_RESOURCE_DEBUG

struct RTL_CRITICAL_SECTION pack=8
  DebugInfo PRTL_CRITICAL_SECTION_DEBUG
  LockCount LONG
  RecursionCount LONG
  OwningThread HANDLE
  LockSemaphore HANDLE
  SpinCount ULONG_PTR

pointer PRTL_CRITICAL_SECTION RTL_CRITICAL_SECTION

flag [NtProtectionFlags] ULONG display=ULONG
  PAGE_NOACCESS          0x01
  PAGE_READONLY          0x02
  PAGE_READWRITE         0x04
  PAGE_WRITECOPY         0x08
  PAGE_EXECUTE           0x10
  PAGE_EXECUTE_READ      0x20
  PAGE_EXECUTE_READWRITE 0x40
  PAGE_EXECUTE_WRITECOPY 0x80
  PAGE_GUARD             0x100
  PAGE_NOCACHE           0x200
  PAGE_WRITECOMBINE      0x400

pointer [NtProtectionFlags*] [NtProtectionFlags] display=PULONG

enum [ProcThreadAttribute] DWORD_PTR display=DWORD_PTR
  PROC_THREAD_ATTRIBUTE_PARENT_PROCESS    0x00020000
  PROC_THREAD_ATTRIBUTE_HANDLE_LIST       0x00020002
  PROC_THREAD_ATTRIBUTE_PREFERRED_NODE    0x00020004
  PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY 0x00020007
  PROC_THREAD_ATTRIBUTE_GROUP_AFFINITY    0x00030003
  PROC_THREAD_ATTRIBUTE_IDEAL_PROCESSOR   0x00030005
  PROC_THREAD_ATTRIBUTE_UMS_THREAD        0x00030006
  PROC_THREAD_ATTRIBUTE_EXTENDED_FLAGS    0x00060001

flag [ProcThreadAttributeFlags] DWORD display=DWORD
  PARENT_PROCESS    0x1
  EXTENDED_FLAGS    0x2
  HANDLE_LIST       0x4
  GROUP_AFFINITY    0x8
  PREFERRED_NODE    0x10
  IDEAL_PROCESSOR   0x20
  UMS_THREAD        0x40
  MITIGATION_POLICY 0x80

struct PROC_THREAD_ATTRIBUTE_ENTRY
  Attribute [ProcThreadAttribute]
  cbSize SIZE_T
  lpValue PVOID length=cbSize

array "PROC_THREAD_ATTRIBUTE_ENTRY [ANYSIZE_ARRAY]" base=PROC_THREAD_ATTRIBUTE_ENTRY count=1

struct PROC_THREAD_ATTRIBUTE_LIST
  dwFlags [ProcThreadAttributeFlags]
  Size ULONG
  Count ULONG
  Reserved ULONG
  Unknown PULONG
  Entries "PROC_THREAD_ATTRIBUTE_ENTRY [ANYSIZE_ARRAY]" count=Count

pointer LPPROC_THREAD_ATTRIBUTE_LIST PROC_THREAD_ATTRIBUTE_LIST

alias [HANDLE_NO_HEX] UINT_PTR display=HANDLE

struct CLIENT_ID
  UniqueProcess [HANDLE_NO_HEX]
  UniqueThread [HANDLE_NO_HEX]

pointer PCLIENT_ID CLIENT_ID

flag NOTIFICATION_MASK ULONG
  TRANSACTION_NOTIFY_PREPREPARE          0x00000001
  TRANSACTION_NOTIFY_PREPARE             0x00000002
  TRANSACTION_NOTIFY_COMMIT              0x00000004
  TRANSACTION_NOTIFY_ROLLBACK            0x00000008
  TRANSACTION_NOTIFY_PREPREPARE_COMPLETE 0x00000010
  TRANSACTION_NOTIFY_PREPARE_COMPLETE    0x00000020
  TRANSACTION_NOTIFY_COMMIT_COMPLETE     0x00000040
  TRANSACTION_NOTIFY_ROLLBACK_COMPLETE   0x00000080
  TRANSACTION_NOTIFY_RECOVER             0x00000100
  TRANSACTION_NOTIFY_SINGLE_PHASE_COMMIT 0x00000200
  TRANSACTION_NOTIFY_DELEGATE_COMMIT     0x00000400
  TRANSACTION_NOTIFY_RECOVER_QUERY       0x00000800
  TRANSACTION_NOTIFY_ENLIST_PREPREPARE   0x00001000
  TRANSACTION_NOTIFY_LAST_RECOVER        0x00002000
  TRANSACTION_NOTIFY_INDOUBT             0x00004000
  TRANSACTION_NOTIFY_PROPAGATE_PULL      0x00008000
  TRANSACTION_NOTIFY_PROPAGATE_PUSH      0x00010000
  TRANSACTION_NOTIFY_MARSHAL             0x00020000
  TRANSACTION_NOTIFY_ENLIST_MASK         0x00040000
  TRANSACTION_NOTIFY_RM_DISCONNECTED     0x01000000
  TRANSACTION_NOTIFY_TM_ONLINE           0x02000000
  TRANSACTION_NOTIFY_COMMIT_REQUEST      0x04000000
  TRANSACTION_NOTIFY_PROMOTE             0x08000000
  TRANSACTION_NOTIFY_PROMOTE_NEW         0x10000000
  TRANSACTION_NOTIFY_REQUEST_OUTCOME     0x20000000
  TRANSACTION_NOTIFY_COMMIT_FINALIZE     0x40000000

struct TRANSACTION_NOTIFICATION
  TransactionKey PVOID
  TransactionNotification NOTIFICATION_MASK display=ULONG
  TmVirtualClock LARGE_INTEGER
  ArgumentLength ULONG

pointer PTRANSACTION_NOTIFICATION TRANSACTION_NOTIFICATION

