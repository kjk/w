include Headers\windows.h.txt
include Headers\cryptography.h.txt

dll Cryptui.dll callingConvention=STDCALL errorFunc=GetLastError onlineHelp=MSDN
category "Security and Identity/Cryptography/Hash and Digital Signature"
category "Security and Identity/Cryptography/Certificate Store"
category "Security and Identity/Cryptography/Certificate"
alias PFNCFILTERPROC LPVOID

alias PFNCCERTDISPLAYPROC LPVOID

union [CRYPTUI_WIZ_EXPORT_INFO_u] display=union
  pCertContext PCCERT_CONTEXT
  pCTLContext PCCTL_CONTEXT
  pCRLContext PCCRL_CONTEXT
  hCertStore HCERTSTORE

struct CRYPTUI_WIZ_EXPORT_INFO
  dwSize DWORD
  pwszExportFileName LPCWSTR
  dwSubjectChoice DWORD
   [CRYPTUI_WIZ_EXPORT_INFO_u]
  cStores DWORD
  rghStores HCERTSTORE* count=cStores

pointer PCCRYPTUI_WIZ_EXPORT_INFO CRYPTUI_WIZ_EXPORT_INFO

enum [CRYPTUI_WIZ_IMPORT_SRC_INFO_CHOICE] DWORD display=DWORD
  CRYPTUI_WIZ_IMPORT_SUBJECT_FILE         1
  CRYPTUI_WIZ_IMPORT_SUBJECT_CERT_CONTEXT 2
  CRYPTUI_WIZ_IMPORT_SUBJECT_CTL_CONTEXT  3
  CRYPTUI_WIZ_IMPORT_SUBJECT_CRL_CONTEXT  4
  CRYPTUI_WIZ_IMPORT_SUBJECT_CERT_STORE   5

union [CRYPTUI_WIZ_IMPORT_SRC_INFO_u] display=union
  pwszFileName LPCWSTR
  pCertContext PCCERT_CONTEXT
  pCTLContext PCCTL_CONTEXT
  pCRLContext PCCRL_CONTEXT
  hCertStore HCERTSTORE

struct CRYPTUI_WIZ_IMPORT_SRC_INFO
  dwSize DWORD
  dwSubjectChoice [CRYPTUI_WIZ_IMPORT_SRC_INFO_CHOICE]
   [CRYPTUI_WIZ_IMPORT_SRC_INFO_u]
  dwFlags DWORD
  pwszPassword LPCWSTR

pointer PCCRYPTUI_WIZ_IMPORT_SRC_INFO CRYPTUI_WIZ_IMPORT_SRC_INFO

union [CRYPTUI_VIEWCERTIFICATE_STRUCT_u] display=union
  pCryptProviderData CRYPT_PROVIDER_DATA*
  hWVTStateData HANDLE

flag [CRYPTUI_VIEWCERTIFICATE_STRUCT_FLAGS] DWORD display=DWORD
  CRYPTUI_HIDE_HIERARCHYPAGE               0x00000001
  CRYPTUI_HIDE_DETAILPAGE                  0x00000002
  CRYPTUI_DISABLE_EDITPROPERTIES           0x00000004
  CRYPTUI_ENABLE_EDITPROPERTIES            0x00000008
  CRYPTUI_DISABLE_ADDTOSTORE               0x00000010
  CRYPTUI_ENABLE_ADDTOSTORE                0x00000020
  CRYPTUI_ACCEPT_DECLINE_STYLE             0x00000040
  CRYPTUI_IGNORE_UNTRUSTED_ROOT            0x00000080
  CRYPTUI_DONT_OPEN_STORES                 0x00000100
  CRYPTUI_ONLY_OPEN_ROOT_STORE             0x00000200
  CRYPTUI_WARN_UNTRUSTED_ROOT              0x00000400
  CRYPTUI_ENABLE_REVOCATION_CHECKING       0x00000800
  CRYPTUI_WARN_REMOTE_TRUST                0x00001000
  CRYPTUI_DISABLE_EXPORT                   0x00002000
  CRYPTUI_ENABLE_REVOCATION_CHECK_END_CERT 0x00004000
  CRYPTUI_ENABLE_REVOCATION_CHECK_CHAIN    0x00008000
  CRYPTUI_DISABLE_HTMLLINK                 0x00010000
  CRYPTUI_DISABLE_ISSUERSTATEMENT          0x00020000
  CRYPTUI_CACHE_ONLY_URL_RETRIEVAL         0x00040000

struct CRYPTUI_VIEWCERTIFICATE_STRUCT
  dwSize DWORD
  hwndParent HWND
  dwFlags [CRYPTUI_VIEWCERTIFICATE_STRUCT_FLAGS]
  szTitle LPCTSTR
  pCertContext PCCERT_CONTEXT
  rgszPurposes LPCSTR* count=cPurposes
  cPurposes DWORD
   [CRYPTUI_VIEWCERTIFICATE_STRUCT_u]
  fpCryptProviderDataTrustedUsage BOOL
  idxSigner DWORD
  idxCert DWORD
  fCounterSigner BOOL
  idxCounterSigner DWORD
  cStores DWORD
  rghStores HCERTSTORE* count=cStores
  cPropSheetPages DWORD
  rgPropSheetPages LPCPROPSHEETPAGE count=cPropSheetPages
  nStartPage DWORD

pointer PCCRYPTUI_VIEWCERTIFICATE_STRUCT CRYPTUI_VIEWCERTIFICATE_STRUCT

struct CRYPTUI_VIEWSIGNERINFO_STRUCT
  dwSize DWORD
  hwndParent HWND
  dwFlags DWORD
  szTitle LPCTSTR
  pSignerInfo CMSG_SIGNER_INFO*
  hMsg HCRYPTMSG
  pszOID LPCSTR
  dwReserved DWORD_PTR
  cStores DWORD
  rghStores HCERTSTORE* count=cStores
  cPropSheetPages DWORD
  rgPropSheetPages LPCPROPSHEETPAGE count=cPropSheetPages

pointer CRYPTUI_VIEWSIGNERINFO_STRUCT* CRYPTUI_VIEWSIGNERINFO_STRUCT

flag [CRYPTUI_SELECT_FLAGS] DWORD display=DWORD
  CRYPTUI_SELECT_ISSUEDTO_COLUMN     0x1
  CRYPTUI_SELECT_ISSUEDBY_COLUMN     0x2
  CRYPTUI_SELECT_INTENDEDUSE_COLUMN  0x4
  CRYPTUI_SELECT_FRIENDLYNAME_COLUMN 0x8
  CRYPTUI_SELECT_LOCATION_COLUMN     0x10
  CRYPTUI_SELECT_EXPIRATION_COLUMN   0x20

struct CRYPTUI_SELECTCERTIFICATE_STRUCT
  dwSize DWORD
  hwndParent HWND
  dwFlags DWORD
  szTitle LPCTSTR
  dwDontUseColumn [CRYPTUI_SELECT_FLAGS]
  szDisplayString LPCTSTR
  pFilterCallback PFNCFILTERPROC
  pDisplayCallback PFNCCERTDISPLAYPROC
  pvCallbackData void*
  cDisplayStores DWORD
  rghDisplayStores HCERTSTORE* count=cDisplayStores
  cStores DWORD
  rghStores HCERTSTORE* count=cStores
  cPropSheetPages DWORD
  rgPropSheetPages LPCPROPSHEETPAGE count=cPropSheetPages
  hSelectedCertStore HCERTSTORE

pointer PCCRYPTUI_SELECTCERTIFICATE_STRUCT CRYPTUI_SELECTCERTIFICATE_STRUCT

struct CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO
  dwSize DWORD
  pGuidSubject GUID*
  cbBlob DWORD
  pbBlob BYTE* length=cbBlob
  pwszDisplayName LPCWSTR

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO

union [CRYPTUI_WIZ_DIGITAL_SIGN_INFO_u1] display=union
  pwszFileName LPCWSTR
  pSignBlobInfo PCCRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO

struct CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO
  dwSize DWORD
  cCertStore DWORD
  rghCertStore HCERTSTORE* count=cCertStore
  pFilterCallback PFNCFILTERPROC
  pvCallbackData void*

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO

struct CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO
  dwSize DWORD
  pwszPvkFileName LPWSTR
  pwszProvName LPWSTR
  dwProvType [CryptProv]

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO

union [CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO_u] display=union
  pPvkFileInfo PCCRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO
  pPvkProvInfo PCRYPT_KEY_PROV_INFO

enum [CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO_CHOICE] DWORD display=DWORD
  CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE 0x01
  CRYPTUI_WIZ_DIGITAL_SIGN_PVK_PROV 0x02

struct CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO
  dwSize DWORD
  pwszSigningCertFileName LPWSTR
  dwPvkChoice [CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO_CHOICE]
   [CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO_u]

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO

union [CRYPTUI_WIZ_DIGITAL_SIGN_INFO_u2] display=union
  pSigningCertContext PCCERT_CONTEXT
  pSigningCertStore PCCRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO
  pSigningCertPvkInfo PCCRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO

flag [CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO_FLAGS] DWORD display=DWORD
  CRYPTUI_WIZ_DIGITAL_SIGN_COMMERCIAL 0x0001
  CRYPTUI_WIZ_DIGITAL_SIGN_INDIVIDUAL 0x0002

struct CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO
  dwSize DWORD
  dwAttrFlags [CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO_FLAGS]
  pwszDescription LPCWSTR
  pwszMoreInfoLocation LPCWSTR
  pszHashAlg LPCSTR
  pwszSigningCertDisplayString LPCWSTR
  hAdditionalCertStore HCERTSTORE
  psAuthenticated PCRYPT_ATTRIBUTES
  psUnauthenticated PCRYPT_ATTRIBUTES

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO

struct CRYPTUI_WIZ_DIGITAL_SIGN_INFO
  dwSize DWORD
  dwSubjectChoice DWORD
   [CRYPTUI_WIZ_DIGITAL_SIGN_INFO_u1]
  dwSigningCertChoice DWORD
   [CRYPTUI_WIZ_DIGITAL_SIGN_INFO_u2]
  pwszTimestampURL LPCWSTR
  dwAdditionalCertChoice DWORD
  pSignExtInfo PCCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_INFO CRYPTUI_WIZ_DIGITAL_SIGN_INFO

struct CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT
  dwSize DWORD
  cbBlob DWORD
  pbBlob BYTE* length=cbBlob

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT

pointer PCCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT* PCCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT

struct CRYPTUI_CERT_MGR_STRUCT
  dwSize DWORD
  hwndParent HWND
  dwFlags DWORD
  pwszTitle LPCWSTR
  pszInitUsageOID LPCSTR

pointer PCCRYPTUI_CERT_MGR_STRUCT CRYPTUI_CERT_MGR_STRUCT

flag [CryptUiWizFlags] DWORD display=DWORD
  CRYPTUI_WIZ_NO_UI                            0x0001
  CRYPTUI_WIZ_DIGITAL_SIGN_EXCLUDE_PAGE_HASHES 0x0002
  CRYPTUI_WIZ_NO_UI_EXCEPT_CSP                 0x0003
  CRYPTUI_WIZ_EXPORT_PRIVATE_KEY               0x0100
  CRYPTUI_WIZ_EXPORT_NO_DELETE_PRIVATE_KEY     0x0200
  CRYPTUI_WIZ_IMPORT_NO_CHANGE_DEST_STORE      0x00010000
  CRYPTUI_WIZ_IMPORT_ALLOW_CERT                0x00020000
  CRYPTUI_WIZ_IMPORT_ALLOW_CRL                 0x00040000
  CRYPTUI_WIZ_IMPORT_ALLOW_CTL                 0x00080000
  CRYPTUI_WIZ_IMPORT_TO_LOCALMACHINE           0x00100000
  CRYPTUI_WIZ_IMPORT_TO_CURRENTUSER            0x00200000
  CRYPTUI_WIZ_IMPORT_REMOTE_DEST_STORE         0x00400000

func CryptUIWizDigitalSign
  BOOL
  dwFlags DWORD
  hwndParent HWND
  pwszWizardTitle LPCWSTR
  pDigitalSignInfo PCCRYPTUI_WIZ_DIGITAL_SIGN_INFO
  ppSignContext PCCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT*

func CryptUIWizFreeDigitalSignContext
  BOOL
  pSignContext PCCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT

func CryptUIWizExport
  BOOL
  dwFlags [CryptUiWizFlags]
  hwndParent HWND
  pwszWizardTitle LPCWSTR
  pExportInfo PCCRYPTUI_WIZ_EXPORT_INFO
  pvoid void*

func CryptUIWizImport
  BOOL
  dwFlags [CryptUiWizFlags]
  hwndParent HWND
  pwszWizardTitle LPCWSTR
  pImportSrc PCCRYPTUI_WIZ_IMPORT_SRC_INFO
  hDestCertStore HCERTSTORE

func CryptUIDlgCertMgr
  BOOL
  pCryptUICertMgr PCCRYPTUI_CERT_MGR_STRUCT

func CryptUIDlgSelectCertificate bothCharset
  success NotEqual=0
  PCCERT_CONTEXT
  pcsc PCCRYPTUI_SELECTCERTIFICATE_STRUCT

func CryptUIDlgSelectCertificateFromStore
  success NotEqual=0
  PCCERT_CONTEXT
  hCertStore HCERTSTORE
  hwnd HWND
  pwszTitle LPCWSTR
  pwszDisplayString LPCWSTR
  dwDontUseColumn DWORD
  dwFlags DWORD
  pvReserved void*

func CryptUIDlgViewCertificate bothCharset
  BOOL
  pCertViewInfo PCCRYPTUI_VIEWCERTIFICATE_STRUCT
  pfPropertiesChanged BOOL*

func CryptUIDlgViewContext
  BOOL
  dwContextType DWORD
  pvContext "const void*"
  hwnd HWND
  pwszTitle LPCWSTR
  dwFlags DWORD
  pvReserved void*

func CryptUIDlgViewSignerInfo bothCharset
  BOOL
  pcvsi CRYPTUI_VIEWSIGNERINFO_STRUCT*

